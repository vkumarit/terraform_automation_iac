

Login to azure using Azure CLI:
$ az login --service-principal --username <-subscription id-> --password <-p. a. token-> --tenant <-tenant id->

Use command to find available names for storage account:
$ az storage account check-name --name <-name->

Create Service Principal(SPN):
$ az ad sp create-for-rbac --name "tf-bootstrap-sp" --role Contributor --scopes /subscriptions/{your-sub-id} --sdk-auth

Create service connection:
$ az devops ?

Role Assignment: 
$ az role assignment create \
  --role "Key Vault Crypto Officer" \
  --assignee usrlsothdevops@gmail.com \
  --scope /subscriptions/2b2f02f7-dde2-47db-974c-47d2182721ae/resourceGroups/myTFResourceGroup/providers/Microsoft.KeyVault/vaults/prodmyappkv

OS Lookup for VMs: 

# All os images in location
$ az vm image list --location "Australia East" --output table --all

*Shows URN format: publisher:offer:sku:version
*Latest for version to auto-pick the newest patched image

# Specific publisher (e.g., Canonical/Ubuntu)
$ az vm image list --publisher Canonical --location "Australia East" --all --output table

# Filter by offer/SKU (e.g., Ubuntu Jammy 22.04 LTS)
$ az vm image list --publisher Canonical --offer 0001-com-ubuntu-server-jammy --sku 22_04-lts --location "Australia East" --output table

# Rotate secret value like github token
az keyvault secret set \
  --vault-name myvault \
  --name githubtoken-feb \
  --value NEW_TOKEN
 
## selection of source_image_reference 
--------------------------------------
#List Publishers
az vm image list-publishers \
  --location <region> \
  --output table

eg: az vm image list-publishers --location australiaeast --output table
  
#List Offers For Publisher
az vm image list-offers \
  --location <region> \
  --publisher <publishers_name> \
  --output table

eg: az vm image list-offers --location australiaeast --publisher cognosys --output table

#List SKUs
az vm image list-skus \
  --location <region> \
  --publisher <publishers_name> \
  --offer <publishers_name> \
  --output table

eg: 
az vm image list-skus --location australiaeast --publisher cognosys --offer centos-8-3-free \
  --output table
  
#List Versions (IMPORTANT)
az vm image list \
  --location <region> \
  --publisher <publishers_name> \
  --offer <publishers_name> \
  --sku <chosen sku> \
  --all \
  --output table

Example:
az vm image list \
  --location australiaeast \
  --publisher cognosys \
  --offer centos-8-3-free \
  --sku centos-8-3-free \
  --all \
  --output table
will get,
Architecture    Offer            Publisher    Sku              Urn                                                   Version
--------------  ---------------  -----------  ---------------  ----------------------------------------------------  -----------
x64             centos-8-3-free  cognosys     centos-8-3-free  cognosys:centos-8-3-free:centos-8-3-free:1.2019.0810  1.2019.0810

--------------------------------------


